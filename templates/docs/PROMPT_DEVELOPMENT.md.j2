# Prompt Development Guide

Complete guide for developing, testing, and deploying prompts for the {{ title }} application.

## Overview

Prompts are the system instructions that guide each agent's behavior. This application uses a **template-driven, versioned prompt system** that supports:

- âœ… Local development and testing without cloud deployment
- âœ… Git-based version control
- âœ… Azure AI Foundry integration for production
- âœ… Variable substitution for runtime context
- âœ… Automatic deployment pipeline integration

## Prompt Architecture

### Directory Structure

```
{{ goal_id }}/
â”œâ”€â”€ prompts/                      # Generated prompt files
{% for agent_name in agents.keys() %}
â”‚   â”œâ”€â”€ {{ agent_name }}.md       # {{ agent_name | replace('_', ' ') | title }} instructions
{% endfor %}
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ test_prompts.py           # ðŸ§ª Local testing utility
â”‚   â”œâ”€â”€ publish_prompts.py        # ðŸ“¤ AI Foundry publishing
â”‚   â””â”€â”€ deploy.sh                 # Deployment (includes prompt publishing)
â””â”€â”€ config/
    â””â”€â”€ goal_spec.json            # Configuration (AI Foundry settings)
```

### Prompt Template Variables

All prompts support these runtime variables:

| Variable | Description | Example |
|----------|-------------|---------|
| `$context` or `{{context}}` | Current conversation context (JSON) | `{"key": "value"}` |
| `$history` or `{{history}}` | Recent conversation messages | `"User: Hello\nAgent: Hi!"` |
| `$user_message` or `{{user_message}}` | Latest user input | `"Help me with X"` |
| `$task_description` or `{{task_description}}` | Current task description | `"Process user request"` |

**Syntax**: Use `$variable` or `${variable}` for substitution (Python `string.Template` format).

## Local Development Workflow

### 1. Edit Prompts

Prompts are plain Markdown files in `prompts/`:

```bash
# Open prompt in your favorite editor
vim prompts/{{ agents.keys() | list | first }}.md
```

### 2. Test Locally (No Cloud Required)

The `test_prompts.py` script lets you validate prompts **without deploying to Azure**.

#### Test a Specific Agent

```bash
python3 scripts/test_prompts.py {{ agents.keys() | list | first }}
```

#### Test All Prompts

```bash
python3 scripts/test_prompts.py all
```

#### Interactive Testing Mode

```bash
python3 scripts/test_prompts.py interactive
```

Interactive REPL for experimentation:

```
prompt> list
Available prompts ({{ agents | length }}):
{% for agent_name in agents.keys() %}
  - {{ agent_name }}
{% endfor %}

prompt> set user_message Your test message here
prompt> test {{ agents.keys() | list | first }}
```

### 3. Iterate and Refine

**No deployment needed** - instant feedback loop!

## Deployment Workflow

### Publishing Prompts to Azure AI Foundry

```bash
./scripts/deploy.sh
```

The deployment script automatically publishes prompts to AI Foundry with git-based versioning.

## Configuration

Enable AI Foundry in `config/goal_spec.json`:

```json
{
  "ai_foundry": {
    "subscription_id": "your-subscription-id",
    "resource_group": "your-resource-group",
    "workspace_name": "your-ai-foundry-workspace",
    "features": {
      "prompt_flow": {
        "enabled": true,
        "cache_ttl_seconds": 3600
      }
    }
  }
}
```

## Versioning Strategy

Every deployment creates a versioned prompt snapshot using the git commit hash.

## Best Practices

1. **Use descriptive, action-oriented prompts**
2. **Include examples** of good interactions
3. **Test with realistic context** values
4. **Version control prompts** like code
5. **Monitor prompt performance** in Azure AI Foundry

## Troubleshooting

### Prompt Not Loading
- Check file is named `{agent_name}.md`
- Test locally: `python3 scripts/test_prompts.py agent_name`

### Variables Not Substituting
- Use `$variable` or `${variable}` syntax
- Ensure variable is passed in context

### AI Foundry Publishing Fails
- Verify `AI_FOUNDRY_ENABLED=true`
- Check Azure credentials and permissions

---

**Generated by GoalGen** | [Documentation](https://github.com/yourorg/goalgen)
